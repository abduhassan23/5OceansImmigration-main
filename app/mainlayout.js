import React from "react";
import Header from "./components/Header";
import Footer from "./components/Footer";
import "./globals.css";
import { useAuthState } from 'react-firebase-hooks/auth';
import { auth } from '../app/firebase/config';
import { ThemeProvider } from "./context/themecontext";
import { Analytics } from '@vercel/analytics/react';
import dynamic from 'next/dynamic';

// Dynamic import with error handling to properly load SpeedInsights this code was generated by ChatGPT, Vercel Insights, and StackOver Flow 
// Prompt: "How can i dynamically import a component in Next.js and add error handling? im dealing with this error "Error: There was an error while hydrating this Suspense boundary. Switched to client rendering" with SpeedInsights for this section here "pasted reference code section "
const SpeedInsights = dynamic(() => import('@vercel/speed-insights/next').then(mod => mod.SpeedInsights), { 
  ssr: false,
  loading: () => <p>Loading Speed Insights...</p>, 
  onError: (error) => {
    console.error("Error loading SpeedInsights:", error);
    return null;
  },
});

const RootLayout = ({ children }) => {
  const [user] = useAuthState(auth);

  return (
    <ThemeProvider>
      <div className="flex flex-col min-h-screen">
        <Header />
        <main className="flex-grow">
          {children}
        </main>
        <Footer />
      </div>
      <Analytics />
      {/*Chat GPT generated line for Speed Insights on Vercel*/}
      {SpeedInsights && <SpeedInsights />}
    </ThemeProvider>
  );
};

export default RootLayout;
